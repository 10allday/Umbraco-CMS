<div class="umb-block-editor"  ng-controller="Umbraco.Editors.MediaEntryEditorController as vm">

    <ng-form name="vm.imageCropperForm" val-form-manager>

        <umb-editor-view umb-tabs ng-if="!page.loading">

            <umb-editor-header
                name="vm.model.title"
                name-required="false"
                name-locked="true"
                hide-alias="true"
                hide-icon="true"
                hide-description="true">
            </umb-editor-header>

            <div class="umb-editor-container umb-panel-body umb-scrollable row-fluid">

                <div ng-show="vm.media.trashed" class="umb-editor--trashed-message">
                    <i class="icon icon-trash"></i> <localize key="content_nodeIsInTrash">This item is in the Recycle Bin</localize>
                </div>

                <div class="umb-pane">
                    <div class="imagecropper clearfix">

                        <div ng-if="vm.currentCrop" style="float:left; max-width: 100%;" class="clearfix">
                            <div class="umb-cropper__container">

                                <div ng-if="vm.currentCrop">
                                    <umb-image-crop height="{{vm.currentCrop.height}}"
                                                    width="{{vm.currentCrop.width}}"
                                                    crop="vm.currentCrop.coordinates"
                                                    center="vm.mediaEntry.focalPoint"
                                                    max-size="450"
                                                    src="vm.imageSrc">
                                    </umb-image-crop>
                                </div>

                                <div class="button-drawer" ng-if="vm.currentCrop">
                                    <button class="btn btn-link" ng-click="reset()"><localize key="imagecropper_reset">Reset this crop</localize></button>
                                </div>

                            </div>
                        </div>

                        <div ng-if="!vm.currentCrop" class="umb-cropper-imageholder clearfix">

                            <umb-image-gravity
                                ng-if="vm.imageSrc"
                                src="vm.imageSrc"
                                center="vm.mediaEntry.focalPoint"
                                on-value-changed="vm.focalPointChanged(left, top)"
                                on-image-loaded="vm.onImageLoaded(isCroppable, hasDimensions)">
                            </umb-image-gravity>

                            <umb-file-icon
                                ng-if="vm.loading === false && !vm.imageSrc"
                                ng-class="{'trashed': vm.media.trashed}"
                                extension="{{vm.media.extension}}"
                                icon="{{vm.media.icon}}"
                                size="s"
                                text="{{vm.media.name}}">
                            </umb-file-icon>

                            <button class="btn btn-link" aria-hidden="true" ng-click="vm.repickMedia()"><i class="icon-wrong"></i> <localize key="mediaPicker_replaceMedia">Replace media</localize></button>
                            <button class="btn btn-link" aria-hidden="true" ng-click="vm.openMedia()"><i class="icon-out"></i> <localize key="mediaPicker_openMedia">Open media</localize></button>
                        </div>


                        <ul ng-if="vm.isCroppable" class="umb-sortable-thumbnails cropList clearfix">
                            <li ng-repeat="crop in vm.mediaEntry.crops track by crop.alias" ng-class="{'current':vm.currentCrop.alias === crop.alias}" ng-click="vm.onCropClicked(crop)">

                                <umb-image-thumbnail center="vm.mediaEntry.focalPoint"
                                                    crop="crop.coordinates"
                                                    src="vm.imageSrc"
                                                    height="{{crop.height}}"
                                                    width="{{crop.width}}"
                                                    max-size="75">
                                </umb-image-thumbnail>

                                <div class="crop-information">
                                    <span class="crop-name crop-text">{{crop.alias}}</span>
                                    <span class="crop-size crop-text">{{crop.width}}px x {{crop.height}}px</span>
                                    <span class="crop-annotation crop-text"><localize key="imagecropper_customCrop" ng-show="vm.isCustomCrop(crop)">User defined</localize>&nbsp;</span>
                                </div>
                            </li>
                        </ul>

                    </div>
                </div>

            </div>

            <umb-editor-footer>

                <!-- Missing breadcrumbs -->

                <umb-editor-footer-content-right>

                    <umb-button
                        action="vm.close()"
                        shortcut="esc"
                        button-style="link"
                        label="{{vm.closeLabel}}"
                        type="button">
                    </umb-button>

                    <umb-button
                        action="vm.submitAndClose()"
                        button-style="primary"
                        state="vm.saveButtonState"
                        label="{{vm.submitLabel}}"
                        type="button">
                    </umb-button>

                </umb-editor-footer-content-right>

            </umb-editor-footer>
        </umb-editor-view>
    </ng-form>
</div>
